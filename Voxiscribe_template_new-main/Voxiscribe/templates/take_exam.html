{% extends "layout.html" %}
{% block content %}
<div class="exam-layout">
  <div class="nav-panel" id="nav-panel"></div>
  <div class="card main-panel">
    <h1 id="exam-title">Exam</h1>
    <div id="timer" class="mb-2">Time Left: <span id="time"></span></div>
    <div id="question-container"></div>
    <div class="controls mt-2">
      <button id="voice-record" class="btn btn-secondary">Start Recording</button>
      <button id="voice-stop" class="btn btn-secondary" style="display:none;">Stop</button>
      <button id="mark-review" class="btn btn-warning">Mark for Review</button>
      <button id="prev-question" class="btn btn-secondary">Previous</button>
      <button id="next-question" class="btn">Next</button>
      <button id="submit-exam" class="btn btn-danger">Submit Exam</button>
    </div>
    <div id="live-transcript" style="margin-top:16px; min-height:32px; color:#333; font-style:italic; background:#f8f9fa; border-radius:6px; padding:8px 12px; display:none;"></div>
  </div>
</div>
<script id="exam-data" type="application/json">{{ exam_json | safe }}</script>
<script src="{{ url_for('static', filename='js/exam.js') }}"></script>
<script src="{{ url_for('static', filename='js/voice.js') }}"></script>
<style>
.exam-layout { display: flex; gap: 24px; }
.nav-panel { min-width: 120px; background: #f4f4f4; border-radius: 8px; padding: 16px; display: flex; flex-direction: column; gap: 8px; }
.nav-btn { width: 40px; height: 40px; border-radius: 50%; border: none; font-weight: bold; font-size: 16px; cursor: pointer; margin-bottom: 4px; }
.nav-btn.answered { background: #d4edda; color: #155724; }
.nav-btn.unanswered { background: #f8d7da; color: #721c24; }
.nav-btn.review { background: #fff3cd; color: #856404; border: 2px solid #ffeeba; }
.main-panel { flex: 1; }
.option { display: block; margin: 8px 0; }
.answer-input { width: 100%; min-height: 120px; }
.listening { animation: pulse 1s infinite; }
#live-transcript { transition: opacity 0.2s; }
@keyframes pulse { 0%{ transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
</style>
{% endblock %}